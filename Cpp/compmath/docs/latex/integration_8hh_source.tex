\doxysection{integration.\+hh}
\hypertarget{integration_8hh_source}{}\label{integration_8hh_source}\index{include/integration.hh@{include/integration.hh}}
\mbox{\hyperlink{integration_8hh}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <stdexcept>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <cassert>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacecompmath}{compmath}}\ \{}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ Func>}
\DoxyCodeLine{00024\ T\ \mbox{\hyperlink{namespacecompmath_a33f82ca4615c994c81dec1641dbaff4d}{integrate\_trapez}}(}
\DoxyCodeLine{00025\ \ \ \ \ Func\ func,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00026\ \ \ \ \ T\ a,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00027\ \ \ \ \ T\ b,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\ =\ 1000\ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00029\ )\ \{}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0)\ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Number\ of\ intervals\ must\ be\ positive"{}});}
\DoxyCodeLine{00031\ \ \ \ \ T\ h\ =\ (b\ -\/\ a)\ /\ n;}
\DoxyCodeLine{00032\ \ \ \ \ T\ result\ =\ 0;}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 1;\ i\ <\ n;\ ++i)\ \{}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ T\ x\ =\ a\ +\ i\ *\ h;}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ result\ +=\ func(x);}
\DoxyCodeLine{00037\ \ \ \ \ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ result\ =\ (func(a)\ +\ 2\ *\ result\ +\ func(b))\ *\ h\ /\ 2;}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00041\ \}}
\DoxyCodeLine{00042\ \ \ \ \ }
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00059\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ Func>}
\DoxyCodeLine{00060\ T\ \mbox{\hyperlink{namespacecompmath_a52e2ea9905606b84ae806e0a53e03784}{integrate\_rect}}(}
\DoxyCodeLine{00061\ \ \ \ \ Func\ func,}
\DoxyCodeLine{00062\ \ \ \ \ T\ a,}
\DoxyCodeLine{00063\ \ \ \ \ T\ b,}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\ =\ 1000,}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ method\ =\ \textcolor{stringliteral}{"{}left"{}}}
\DoxyCodeLine{00066\ )\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0)\ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Number\ of\ intervals\ must\ be\ positive"{}});}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ T\ h\ =\ (b\ -\/\ a)\ /\ n;}
\DoxyCodeLine{00071\ \ \ \ \ T\ result\ =\ 0;}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordflow}{if}\ (method\ ==\ \textcolor{stringliteral}{"{}left"{}})\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ n;\ ++i)\ \{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ T\ x\ =\ a\ +\ i\ *\ h;}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ result\ +=\ func(x);}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (method\ ==\ \textcolor{stringliteral}{"{}right"{}})\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 1;\ i\ <=\ n;\ ++i)\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ T\ x\ =\ a\ +\ i\ *\ h;}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ result\ +=\ func(x);}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00083\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (method\ ==\ \textcolor{stringliteral}{"{}midpoint"{}})\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ n;\ ++i)\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ T\ x\ =\ a\ +\ i\ *\ h\ +\ h\ /\ 2;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ result\ +=\ func(x);}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00088\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Unknown\ rectangle\ method:\ "{}}\ +\ method);}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordflow}{return}\ result\ *\ h;}
\DoxyCodeLine{00092\ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00109\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ Func>}
\DoxyCodeLine{00110\ T\ \mbox{\hyperlink{namespacecompmath_a3c475f9baafb9044e7774b0b06d0a208}{integrate\_simpson}}(}
\DoxyCodeLine{00111\ \ \ \ \ Func\ func,}
\DoxyCodeLine{00112\ \ \ \ \ T\ a,}
\DoxyCodeLine{00113\ \ \ \ \ T\ b,}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\ =\ 1000}
\DoxyCodeLine{00115\ )\ \{}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0\ ||\ n\ \%\ 2\ !=\ 0)}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::invalid\_argument(\textcolor{stringliteral}{"{}Number\ of\ intervals\ must\ be\ positive\ and\ even\ for\ Simpson's\ rule"{}});}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ T\ h\ =\ (b\ -\/\ a)\ /\ n;}
\DoxyCodeLine{00121\ \ \ \ \ T\ result\ =\ func(a)\ +\ func(b);}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 1;\ i\ <\ n;\ ++i)\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ T\ x\ =\ a\ +\ i\ *\ h;}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ \%\ 2\ ==\ 0)}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ result\ +=\ 2\ *\ func(x);}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ result\ +=\ 4\ *\ func(x);}
\DoxyCodeLine{00129\ \ \ \ \ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{return}\ result\ *\ h\ /\ 3;}
\DoxyCodeLine{00132\ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00159\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ Func,\ \textcolor{keyword}{typename}\ Integrator>}
\DoxyCodeLine{00160\ std::pair<T,\ T>\ \mbox{\hyperlink{namespacecompmath_a039b77c1cc6b56852fc495d7628ca41c}{runge\_rule}}(}
\DoxyCodeLine{00161\ \ \ \ \ Integrator\ integrator,}
\DoxyCodeLine{00162\ \ \ \ \ Func\ func,}
\DoxyCodeLine{00163\ \ \ \ \ T\ a,}
\DoxyCodeLine{00164\ \ \ \ \ T\ b,}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n,}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordtype}{int}\ order}
\DoxyCodeLine{00167\ )\ \{}
\DoxyCodeLine{00168\ \ \ \ \ T\ In\ \ =\ integrator(func,\ a,\ b,\ n);}
\DoxyCodeLine{00169\ \ \ \ \ T\ I2n\ =\ integrator(func,\ a,\ b,\ 2*n);}
\DoxyCodeLine{00170\ \ \ \ \ T\ R\ =\ std::abs(I2n\ -\/\ In)\ /\ (std::pow(2,\ order)\ -\/\ 1);}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordflow}{return}\ \{I2n,\ R\};}
\DoxyCodeLine{00172\ \}}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \}}

\end{DoxyCode}
